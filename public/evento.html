<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="shortcut icon" href="">

  <title>Ingressou</title>
  <meta name="description" content="">
  <meta name="keywords" content="">
  <meta name="author" content="">

  <!-- Font -->
  <link href="./css/open_sans.css" rel="stylesheet">

  <!-- Estilo bootstrap -->
  <link rel="stylesheet" href="./lib/bootstrap_v4/css/bootstrap.min.css">
  <!-- Arquivo de estilo -->
  <link rel="stylesheet" href="./css/style.css">
  <!-- Webfonts icons do google -->
  <link rel="stylesheet" href="./lib/webfont/css/materialdesignicons.min.css">

  <!-- Inclusão por tag js (ex.: include='caminho') -->
  <script src="./lib/include/myInclude.js" charset="utf-8"></script>
</head>
<body class="bg-page">
  <!-- Seu site -->

  <header class="text-dark">
    <div class="container">
      <div class="row pt-5 pb-4 pb-sm-4 pt-sm-5 align-items-center navbar navbar-expand-lg">
        <div class="d-block d-sm-none mx-5 pb-4">
          <img src="./img/logo.png" alt="" class="w-100">
        </div>
        <div class="col">
          <ul class="navbar-nav mr-auto flex-row">
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarMenu" aria-controls="navbarMenu" aria-expanded="false" aria-label="Toggle navigation">
              <span class="mdi mdi-menu text-dark"></span>
            </button>
            <li class="nav-item">
              <a href="#" class="mdi mdi-magnify text-dark px-2" data-toggle="collapse" data-target="#navbarSearch" aria-controls="navbarSearch"></a>
            </li>
          </ul>
        </div>
        <div class="col-3 d-none d-sm-block">
          <img src="./img/logo.png" alt="" class="w-100">
        </div>
        <div class="col">
          <ul class="navbar-nav ml-auto flex-row-reverse">
            <li class="nav-item d-flex align-items-center">
              Olá, visitante <a href="#" class="mdi mdi-account-circle text-dark px-2"></a>
            </li>
          </ul>
        </div>
      </div>
    </div>


    <div class="container d-flex justify-content-center">
      <nav id="navbarSearch" class="collapse b">
        <form class="form-inline">
          <input class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search">
          <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
        </form>
      </nav>
    </div>

    <div class="navbar navbar-expand-lg navbar-light pb-0">
      <nav id="navbarMenu" class="collapse navbar-collapse">
        <div class="container">
          <ul class="navbar-nav mr-auto w-100 py-2">
            <li class="nav-item pt-0 px-2">
              <a class="font-normal nav-link text-uppercase text-dark" href="#">home</a>
            </li>
            <li class="nav-item py-0 px-2">
              <a class="font-normal nav-link text-uppercase text-dark" href="#">meus pedidos</a>
            </li>
            <li class="nav-item py-0 px-2">
              <a class="font-normal nav-link text-uppercase text-dark" href="#">informações</a>
            </li>
            <li class="nav-item py-0 px-2">
              <a class="font-normal nav-link text-uppercase text-dark" href="#">ajuda</a>
            </li>
            <li class="nav-item py-0 px-2">
              <a class="font-normal nav-link text-uppercase text-dark" href="#">fale conosco</a>
            </li>
            <li class="ml-auto nav-item py-0 px-2">
              <a class="font-normal nav-link text-uppercase text-dark" href="#">entrar</a>
            </li>
          </ul>
        </div>
      </nav>
    </div>
  </header>

  <section class="container-fluid p-0">
    <div class="w-100 banner-evento" style="background-image: url('./img/banner_eventos/04.png');">
      <img src="./img/banner_eventos/04.png" alt="" class="w-100 invisible">
    </div>
  </section>

  <section class="container border-0 mb-3">
    <div class="row justify-content-center">
      <div class="col-sm-10" style="margin-top: -250px">
        <div class="card bg-white border-0 rounded-0">

          <div class="btn-toolbar justify-content-between" role="toolbar" aria-label="Toolbar with button groups">
            <div class="btn-group btn-group-shared" role="group">
              <button type="button" class="btn bg-white text-dark">
                <span class="mdi mdi-share-variant mdi-24px text-primary"></span>
              </button>
              <div class="mt-1 group-sub-menu">
                <button type="button" class="btn bg-white">
                  <span class="mdi mdi-facebook-box text-dark"></span>
                </button>
                <button type="button" class="btn bg-white">
                  <span class="mdi mdi-whatsapp text-dark"></span>
                </button>
                <button type="button" class="btn bg-white">
                  <span class="mdi mdi-email text-dark"></span>
                </button>
              </div>
            </div>
            <div class="btn-group" role="group">
              <button type="button" class="btn btn-lg btn-success border-0 rounded-0 btn-block px-3 px-sm-5">
                Comprar
              </button>
            </div>
          </div>

          <div class="card-body">
            <h1 class="mt-0 mb-3">A volta do comandante</h1>

            <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3957.407806251758!2d-39.30455078573066!3d-7.307998694725622!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x7a177cb202a0f5b%3A0xa9a7449de327d2d6!2sCheYpe!5e0!3m2!1spt-BR!2sbr!4v1510083941754" width="60%" height="200" frameborder="0" style="border:0" allowfullscreen class="float-right ml-3 mb-3"></iframe>
            <p class="text-justify">
              Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
            </p>
            <p class="text-justify">
              Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
            </p>

            <hr class="my-4">

            <h3>Periodo do evento:</h3>
            <div class="slide-date-ingressos mb-3">
              <ul>
                <li class="p-2">
                  <span class="d-block data">07/12</span>
                  <span class="d-block semana">seg</span>
                </li>
                <li class="p-2">
                  <span class="d-block data">08/12</span>
                  <span class="d-block semana">ter</span>
                </li>
              </ul>
              <button type="button" name="button" class="prev">
                <span class="mdi mdi-chevron-left mdi-24px"></span>
              </button>
              <button type="button" name="button" class="next">
                <span class="mdi mdi-chevron-right mdi-24px"></span>
              </button>
            </div>
            <div class="box-tipo-ingressos">
              <form id="formTiposIngressos">
                <ul class="m-0 p-0">
                  <li>
                    <div class="row">
                      <div class="col-lg-5">
                        <h5>Atrações:</h5>
                        <p class="font-120">Aviões do forró, Mani e banda e arreios do forró</p>
                      </div>
                      <div class="col-lg-7 qtdIngressos"></div>
                    </div>
                  </li>
                </ul>
              </form>
            </div>

            <div class="resumo mt-4">
              <h3>Resumo</h3>
              <table class="table table-resumo">
                <thead>
                  <tr>
                    <th class="w-50">Nome</th>
                    <th class="text-center">Data</th>
                    <th class="text-center">Quantidade</th>
                    <th class="text-right w-25">Valor</th>
                  </tr>
                </thead>
                <tbody></tbody>
                <tfoot></tfoot>
              </table>
            </div>

            <button type="button" class="btn btn-lg btn-success btn-comprar border-0 rounded-0 float-right px-3 px-sm-5" disabled>Comprar <span class="mdi mdi-chevron-right"></span></button>

          </div>
        </div>
      </div>
    </div>
  </section>

  <section class="pre-footer bg-dark text-light py-5">
    <div class="container py-4">
      <div class="row">
        <div class="col-sm-6">
          <h5>Como entro em contato?</h5>
          <a href="#" class="mdi mdi-whatsapp mdi-36px text-light"></a>
          <a href="#" class="mdi mdi-phone mdi-36px text-light"></a>
          <a href="#" class="mdi mdi-email mdi-36px text-light"></a>

          <h5 class="mt-5">Posso confiar no site?</h5>
        </div>
        <div class="col-sm-6 text-right">
          <h5 class="mt-5 mt-sm-0">Como entro em contato?</h5>
          <a href="#" class="mdi mdi-facebook-box mdi-36px text-light"></a>
          <a href="#" class="mdi mdi-instagram mdi-36px text-light"></a>
          <a href="#" class="mdi mdi-twitter mdi-36px text-light"></a>

          <h5 class="mt-5">Como pago pelos ingressos?</h5>
        </div>
        <div class="col-12">
          <h5 class="mt-5">O que ainda posso ver?</h5>
          <a href="#" class="btn btn-default text-light px-0 mr-3">Troca de voucher</a>
          <a href="#" class="btn btn-default text-light px-0 mr-3">Cancelamento</a>
          <a href="#" class="btn btn-default text-light px-0 mr-3">Termos de uso</a>
          <a href="#" class="btn btn-default text-light px-0 mr-3">Privacidade e Segurança</a>
        </div>

      </div>
    </div>
  </section>

  <footer>
    <div class="container py-4">
      <div class="row align-items-center">
        <div class="col-sm-8 text-center text-sm-left">
          <p class="m-0 text-light">© 2017 INGRESSOU. Todos os direitos reservados</p>
        </div>
        <div class="col-sm-4 text-center text-sm-right mt-3 mt-sm-0">
          <img src="./img/logo_branca.png" alt="" height="50px">
        </div>
      </div>
    </div>
  </footer>


  <!-- JavaScript jquery -->
  <script src="./lib/jquery/jquery-3.1.1.min.js" charset="utf-8"></script>
  <!-- JavaScript popper -->
  <script src="./lib/bootstrap_v4/js/popper.min.js" charset="utf-8"></script>
  <!-- JavaScript bootstrap -->
  <script src="./lib/bootstrap_v4/js/bootstrap.min.js" charset="utf-8"></script>
  <!-- Sly Slide -->
  <script src="./lib/sly/sly.min.js" charset="utf-8"></script>

  <script src="./js/mask.js" charset="utf-8"></script>

  <script type="text/javascript">
  $(function () {

    var $bComprar = $('button.btn-comprar')
    var getIngressos = [{
      id: "2131",
      nome: "Pista",
      data: "18/11/2017",
      lote: "1",
      valor: 30.00,
      quantidade: 10
    },{
      id: "2132",
      nome: "Vip",
      data: "18/11/2017",
      lote: "1",
      valor: 60.90,
      quantidade: 15
    }]

    getIngressos.forEach(function (elem) {
      $('.qtdIngressos').append("<div class='form-group row align-items-center'><label class='col-md-6 col-form-label text-md-right'>"+elem.nome+" - "+elem.lote+"º lote<br><span class='text-success'>"+mask.formatValor(elem.valor)+"</span></label><div class='input-group col-md-6'><input type='hidden' value='"+elem.quantidade+"' class='valueMax'><button type='button' name='button' class='input-group-addon minus mdi mdi-minus-circle-outline mdi-24px'></button><input name='"+elem.id+"' type='text' class='form-control text-center' value='0' readonly><button type='button' name='button' class='input-group-addon plus mdi mdi-plus-circle-outline mdi-24px'></button></div></div>")
      elem.quantidade = 0
    })

    $('[data-toggle="tooltip"]').tooltip()

    var $wrap  = $('.slide-date-ingressos').parent()
    var slyOptions = {
      horizontal: 1,       itemNav: 'centered',
      smart: 1,            activateMiddle: 1,
      activateOn: 'click', mouseDragging: 1,
      touchDragging: 1,    releaseSwing: 1,
      startAt: 0,          scrollBy: 1,
      speed: 300,          elasticBounds: 1,
      easing: 'linear',    dragHandle: 1,
      dynamicHandle: 1,

      // Buttons
      prev: $wrap.find('.prev'),
      next: $wrap.find('.next')
    }

    var frame = new Sly('.slide-date-ingressos', slyOptions, {
      active: function (e, i) {
        $('.box-tipo-ingressos ul .active').removeClass('active')
        $($('.box-tipo-ingressos ul li')[i]).addClass('active')
      }
    }).init()

    $bComprar.on('click', function () {
      getIngressos.forEach(function (e) {
        (e.quantidade > 0) ? console.log(e) : console.log('')
      })
    })

    function atualizaTotal() {
      var $list = $('.ingressoValue')
      var $tfoot = $('.table-resumo tfoot')
      var _total = 0

      $list.each(function () {
        _total += mask.desFormatValor( $(this).text() )
      })

      _total ? $bComprar.removeAttr("disabled") : $bComprar.attr("disabled", true)
      $tfoot.html("<tr><td colspan='3' class='text-right'>Total</td><td class='text-right'>"+mask.formatValor(_total)+"</td></tr>")
    }

    function povoaTabela(obj) {
      var _obj = obj
      var $table = $('.table-resumo')
      var $tr = $("#"+_obj.id)

      if(!$tr[0]){
        $table.find('tbody').append("<tr id='"+_obj.id+"'><td>"+_obj.nome+"</td><td class='text-center'>"+_obj.data+"</td><td class='ingressoQtd text-center'>"+_obj.quantidade+"</td><td class='ingressoValue text-right'>"+mask.formatValor(_obj.quantidade*_obj.valor)+"</td></tr>")
        atualizaTotal()
      }else{
        if (parseInt(_obj.quantidade) > 0) {
          $tr.find(".ingressoQtd").text(_obj.quantidade)
          $tr.find(".ingressoValue").text(mask.formatValor(_obj.quantidade*_obj.valor))
          atualizaTotal()
        }else{
          $tr.remove();
          atualizaTotal()
        }
      }
    }

    /* Escolhendo quantidade dos ingressos */
    $('.box-tipo-ingressos .minus').on('click', function () {
      $input = $(this).next()
      if(parseInt($input.val()) > 0){
        $input.val( parseInt($input.val()) - 1 )

        getIngressos.forEach(function (e) {
          if (e.id === $input[0].name) {
            e.quantidade = $input.val()
            povoaTabela(e)
          }
        })

      }
    })
    $('.box-tipo-ingressos .plus').on('click', function () {
      $input = $(this).prev()
      max = parseInt( $input.parent().find('.valueMax').val() )
      if (parseInt($input.val()) < max){
        $input.val( parseInt($input.val()) + 1 )

        getIngressos.forEach(function (e) {
          if (e.id === $input[0].name) {
            e.quantidade = $input.val()
            povoaTabela(e)
          }
        })

      }
    })

    $('#formTiposIngressos').on("submit", function( event ) {
      event.preventDefault()
      var tiposIngressos = []
      $( this ).serialize().split('&').forEach(function(e) {
        tiposIngressos[e.split('=')[0]] = e.split('=')[1]
      })
      console.log(tiposIngressos);
    })
  })
  </script>
</body>
</html>
